# üìä –û—Ç—á–µ—Ç: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π –≤ –ø—Ä–æ—Ñ–∏–ª—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 1 –æ–∫—Ç—è–±—Ä—è 2025  
**–¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –û–¥–Ω–∞ –∫–æ–º–ø–∞–Ω–∏—è ‚Üí –û–¥–∏–Ω —Å–∫–ª–∞–¥

---

## üìã –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ

### ‚úÖ **–í–µ—Ä–¥–∏–∫—Ç:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤–æ–∑–º–æ–∂–Ω–∞, –Ω–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç –ó–ù–ê–ß–ò–¢–ï–õ–¨–ù–´–• –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** üî¥ **–í–´–°–û–ö–ê–Ø** (7/10)  
**–û–±—ä–µ–º —Ä–∞–±–æ—Ç—ã:** ~40-50 —á–∞—Å–æ–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏  
**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:** ~45-50 —Ñ–∞–π–ª–æ–≤  
**–†–∏—Å–∫–∏:** –°—Ä–µ–¥–Ω–∏–µ (–≤–æ–∑–º–æ–∂–Ω—ã –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∏–∫–µ –¥–æ—Å—Ç—É–ø–∞)

---

## üèóÔ∏è –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### **–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö:**
```
User (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
  ‚îú‚îÄ company_id (–æ–¥–Ω–∞ –∫–æ–º–ø–∞–Ω–∏—è)
  ‚îú‚îÄ warehouse_id (–æ–¥–∏–Ω —Å–∫–ª–∞–¥)
  ‚îî‚îÄ role (—Ä–æ–ª—å)

Company (–ö–æ–º–ø–∞–Ω–∏—è)
  ‚îî‚îÄ hasMany(Warehouse) ‚Üí —Å–∫–ª–∞–¥—ã –∫–æ–º–ø–∞–Ω–∏–∏
  ‚îî‚îÄ hasMany(User) ‚Üí —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∫–æ–º–ø–∞–Ω–∏–∏

Warehouse (–°–∫–ª–∞–¥)
  ‚îî‚îÄ belongsTo(Company)
```

### **–ü—Ä–∏–Ω—Ü–∏–ø—ã –¥–æ—Å—Ç—É–ø–∞:**
1. **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä** - –≤–∏–¥–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤—Å–µ—Ö –∫–æ–º–ø–∞–Ω–∏–π
2. **–ú–µ–Ω–µ–¥–∂–µ—Ä/–û–ø–µ—Ä–∞—Ç–æ—Ä** - –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ —Å–≤–æ–µ–π –∫–æ–º–ø–∞–Ω–∏–∏ (`company_id`)
3. **–°–∫–ª–∞–¥—Å–∫–æ–π —Ä–∞–±–æ—Ç–Ω–∏–∫** - –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ —Å–≤–æ–µ–≥–æ —Å–∫–ª–∞–¥–∞ (`warehouse_id`)

---

## üìä –ê–Ω–∞–ª–∏–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è company_id –∏ warehouse_id

### **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
- **`company_id` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:** –≤ 15 —Ñ–∞–π–ª–∞—Ö, 47 –≤—Ö–æ–∂–¥–µ–Ω–∏–π
- **`warehouse_id` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:** –≤ 33 —Ñ–∞–π–ª–∞—Ö, 179 –≤—Ö–æ–∂–¥–µ–Ω–∏–π

### **–ú–µ—Å—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

#### 1. **–ú–æ–¥–µ–ª–∏ (4 —Ñ–∞–π–ª–∞):**
- `app/Models/User.php` - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–≤—è–∑–µ–π
- `app/Models/Company.php` - —Å–≤—è–∑—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- `app/Models/Warehouse.php` - —Å–≤—è–∑—å —Å –∫–æ–º–ø–∞–Ω–∏–µ–π
- `app/Models/Sale.php`, `Product.php`, etc. - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–∫–ª–∞–¥—É

#### 2. **API –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (7 —Ñ–∞–π–ª–æ–≤):**
- `app/Http/Controllers/Api/UserController.php` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ company_id
- `app/Http/Controllers/Api/WarehouseController.php` - –ø—Ä–æ–≤–µ—Ä–∫–∞ warehouse_id –¥–æ—Å—Ç—É–ø–∞
- `app/Http/Controllers/Api/ProductController.php` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ —Å–∫–ª–∞–¥—É
- `app/Http/Controllers/Api/SaleController.php` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø—Ä–æ–¥–∞–∂–∞–º
- `app/Http/Controllers/Api/RequestController.php` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- `app/Http/Controllers/Api/StockController.php` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤
- `app/Http/Controllers/Api/ReceiptController.php` - –ø—Ä–∏–µ–º–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤

#### 3. **Filament Resources (15 —Ñ–∞–π–ª–æ–≤):**
- `app/Filament/Resources/UserResource.php` - —Å–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `app/Filament/Resources/ProductResource.php` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–æ–≤
- `app/Filament/Resources/SaleResource.php` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–¥–∞–∂
- `app/Filament/Resources/WarehouseResource.php` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∫–ª–∞–¥–∞–º–∏
- `app/Filament/Resources/StockResource.php` - —Å–∫–ª–∞–¥—Å–∫–∏–µ –æ—Å—Ç–∞—Ç–∫–∏
- –ò –¥—Ä. (–µ—â–µ 10 —Ä–µ—Å—É—Ä—Å–æ–≤)

#### 4. **Filament Pages (5 —Ñ–∞–π–ª–æ–≤):**
- `app/Filament/Pages/StockOverview.php` - –æ–±–∑–æ—Ä —Å–∫–ª–∞–¥–æ–≤
- Create/Edit —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤

#### 5. **Policies (2 —Ñ–∞–π–ª–∞):**
- `app/Policies/UserPolicy.php` - –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- `app/Policies/ProductPolicy.php` - –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–æ–≤–∞—Ä–∞–º

#### 6. **–ú–∏–≥—Ä–∞—Ü–∏–∏ (2 —Ñ–∞–π–ª–∞):**
- `database/migrations/2025_08_04_073800_add_role_and_company_fields_to_users_table.php`

---

## üîÑ –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∫–æ–º–ø–∞–Ω–∏–π

### **1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (3-4 —á–∞—Å–∞)**

#### **–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É `company_user` (many-to-many):**
```php
Schema::create('company_user', function (Blueprint $table) {
    $table->id();
    $table->foreignId('user_id')->constrained()->onDelete('cascade');
    $table->foreignId('company_id')->constrained()->onDelete('cascade');
    $table->boolean('is_primary')->default(false); // –æ—Å–Ω–æ–≤–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è
    $table->string('role_in_company')->nullable(); // —Ä–æ–ª—å –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏
    $table->timestamps();
    
    $table->unique(['user_id', 'company_id']);
});
```

#### **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —Ç–∞–±–ª–∏—Ü–∞ `user_warehouse` –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Å–∫–ª–∞–¥–æ–≤:**
```php
Schema::create('user_warehouse', function (Blueprint $table) {
    $table->id();
    $table->foreignId('user_id')->constrained()->onDelete('cascade');
    $table->foreignId('warehouse_id')->constrained()->onDelete('cascade');
    $table->boolean('is_primary')->default(false);
    $table->timestamps();
    
    $table->unique(['user_id', 'warehouse_id']);
});
```

#### **–ú–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö:**
- –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑ `users.company_id` –≤ `company_user`
- –ü–æ–º–µ—Ç–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–≤—è–∑–∏ –∫–∞–∫ `is_primary = true`

---

### **2. –ú–æ–¥–µ–ª—å User (2-3 —á–∞—Å–∞)**

#### **–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `app/Models/User.php`:**

```php
// –£–±—Ä–∞—Ç—å:
// protected $fillable = ['company_id', 'warehouse_id'];

// –î–æ–±–∞–≤–∏—Ç—å:
public function companies(): BelongsToMany
{
    return $this->belongsToMany(Company::class, 'company_user')
        ->withPivot('is_primary', 'role_in_company')
        ->withTimestamps();
}

public function warehouses(): BelongsToMany
{
    return $this->belongsToMany(Warehouse::class, 'user_warehouse')
        ->withPivot('is_primary')
        ->withTimestamps();
}

// –ü–æ–ª—É—á–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é –∫–æ–º–ø–∞–Ω–∏—é
public function getPrimaryCompanyAttribute(): ?Company
{
    return $this->companies()->wherePivot('is_primary', true)->first();
}

// –ü–æ–ª—É—á–∏—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫–ª–∞–¥
public function getPrimaryWarehouseAttribute(): ?Warehouse
{
    return $this->warehouses()->wherePivot('is_primary', true)->first();
}

// –ü–æ–ª—É—á–∏—Ç—å ID –≤—Å–µ—Ö –∫–æ–º–ø–∞–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
public function getCompanyIdsAttribute(): array
{
    return $this->companies()->pluck('companies.id')->toArray();
}

// –ü–æ–ª—É—á–∏—Ç—å ID –≤—Å–µ—Ö —Å–∫–ª–∞–¥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
public function getWarehouseIdsAttribute(): array
{
    return $this->warehouses()->pluck('warehouses.id')->toArray();
}

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–æ–º–ø–∞–Ω–∏–∏
public function hasAccessToCompany(int $companyId): bool
{
    if ($this->isAdmin()) {
        return true;
    }
    return $this->companies()->where('companies.id', $companyId)->exists();
}

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–∫–ª–∞–¥—É
public function hasAccessToWarehouse(int $warehouseId): bool
{
    if ($this->isAdmin()) {
        return true;
    }
    return $this->warehouses()->where('warehouses.id', $warehouseId)->exists();
}
```

**–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ (accessor –¥–ª—è —Å—Ç–∞—Ä–æ–≥–æ –∫–æ–¥–∞):**
```php
// –î–ª—è —Å—Ç–∞—Ä–æ–≥–æ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç $user->company_id
public function getCompanyIdAttribute(): ?int
{
    return $this->primary_company?->id;
}

// –î–ª—è —Å—Ç–∞—Ä–æ–≥–æ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç $user->warehouse_id
public function getWarehouseIdAttribute(): ?int
{
    return $this->primary_warehouse?->id;
}
```

---

### **3. API –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (8-10 —á–∞—Å–æ–≤)**

#### **–§–∞–π–ª—ã, —Ç—Ä–µ–±—É—é—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**

##### **3.1. UserController.php**
```php
// –ë—ã–ª–æ:
if (!$user->isAdmin()) {
    if ($user->warehouse_id) {
        $query->where('warehouse_id', $user->warehouse_id);
    }
}

// –°—Ç–∞–Ω–µ—Ç:
if (!$user->isAdmin()) {
    $warehouseIds = $user->warehouse_ids;
    if (!empty($warehouseIds)) {
        $query->whereIn('warehouse_id', $warehouseIds);
    }
}
```

##### **3.2. WarehouseController.php**
```php
// –ë—ã–ª–æ:
if ($user->warehouse_id) {
    $query->where('id', $user->warehouse_id);
}

// –°—Ç–∞–Ω–µ—Ç:
$warehouseIds = $user->warehouse_ids;
if (!empty($warehouseIds)) {
    $query->whereIn('id', $warehouseIds);
}
```

##### **3.3. ProductController.php**
```php
// –ë—ã–ª–æ:
if ($user->warehouse_id) {
    $query->where('warehouse_id', $user->warehouse_id);
}

// –°—Ç–∞–Ω–µ—Ç:
$warehouseIds = $user->warehouse_ids;
if (!empty($warehouseIds)) {
    $query->whereIn('warehouse_id', $warehouseIds);
}
```

##### **3.4. SaleController.php**
```php
// –ë—ã–ª–æ:
if (!$user->isAdmin()) {
    if ($user->warehouse_id !== $request->warehouse_id) {
        return response()->json(['message' => '–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω'], 403);
    }
}

// –°—Ç–∞–Ω–µ—Ç:
if (!$user->isAdmin()) {
    if (!$user->hasAccessToWarehouse($request->warehouse_id)) {
        return response()->json(['message' => '–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω'], 403);
    }
}
```

**–ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ç—Ä–µ–±—É—é—Ç—Å—è –≤:**
- RequestController.php
- StockController.php
- ReceiptController.php
- ProductTemplateController.php

---

### **4. Filament Resources (10-12 —á–∞—Å–æ–≤)**

#### **4.1. UserResource.php - –¥–æ–±–∞–≤–∏—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏—è–º–∏**
```php
Forms\Components\Select::make('companies')
    ->label('–ö–æ–º–ø–∞–Ω–∏–∏')
    ->multiple()
    ->relationship('companies', 'name')
    ->preload()
    ->required(),

Forms\Components\Select::make('primary_company_id')
    ->label('–û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è')
    ->relationship('companies', 'name')
    ->required(),

Forms\Components\Select::make('warehouses')
    ->label('–°–∫–ª–∞–¥—ã')
    ->multiple()
    ->relationship('warehouses', 'name')
    ->preload(),
```

#### **4.2. –û–±–Ω–æ–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –≤–æ –≤—Å–µ—Ö Resources:**
- ProductResource.php
- SaleResource.php
- StockResource.php
- WarehouseResource.php
- RequestResource.php
- ProductInTransitResource.php
- ReceiptResource.php

**–ü—Ä–∏–º–µ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ getEloquentQuery():**
```php
// –ë—ã–ª–æ:
if ($user->company_id) {
    $query->whereHas('warehouse', function ($q) use ($user) {
        $q->where('company_id', $user->company_id);
    });
}

// –°—Ç–∞–Ω–µ—Ç:
$companyIds = $user->company_ids;
if (!empty($companyIds)) {
    $query->whereHas('warehouse', function ($q) use ($companyIds) {
        $q->whereIn('company_id', $companyIds);
    });
}
```

#### **4.3. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π (Create Pages):**
–û–±–Ω–æ–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –≤ Pages/Create*.php —Ñ–∞–π–ª–∞—Ö:
- CreateProduct.php
- CreateSale.php
- CreateRequest.php
- CreateProductInTransit.php

---

### **5. Policies (2-3 —á–∞—Å–∞)**

#### **5.1. UserPolicy.php**
```php
// –ë—ã–ª–æ:
return $user->company_id === $model->company_id;

// –°—Ç–∞–Ω–µ—Ç:
return $user->hasAccessToCompany($model->primary_company->id ?? 0);
```

#### **5.2. ProductPolicy.php**
```php
// –ë—ã–ª–æ:
return (int) $product->warehouse_id === (int) $user->warehouse_id;

// –°—Ç–∞–Ω–µ—Ç:
return $user->hasAccessToWarehouse($product->warehouse_id);
```

---

### **6. Filament Pages (3-4 —á–∞—Å–∞)**

#### **6.1. StockOverview.php**
```php
// –ë—ã–ª–æ:
if ($user->company_id) {
    $query->whereHas('warehouse', function ($q) use ($user) {
        $q->where('company_id', $user->company_id);
    });
}

// –°—Ç–∞–Ω–µ—Ç:
$companyIds = $user->company_ids;
if (!empty($companyIds)) {
    $query->whereHas('warehouse', function ($q) use ($companyIds) {
        $q->whereIn('company_id', $companyIds);
    });
}
```

---

### **7. –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (2 —á–∞—Å–∞)**
- ProductExportController.php
- SaleExportController.php

---

### **8. Factories –∏ Seeders (2 —á–∞—Å–∞)**
–û–±–Ω–æ–≤–∏—Ç—å —Ñ–∞–±—Ä–∏–∫–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–≤—è–∑–µ–π many-to-many

---

### **9. –¢–µ—Å—Ç—ã (5-6 —á–∞—Å–æ–≤)**
–ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã:
- Feature/UserTest.php
- Feature/ProductTest.php
- Feature/SaleTest.php
- Feature/WarehouseTest.php
- –ò –¥—Ä—É–≥–∏–µ...

---

### **10. API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (1-2 —á–∞—Å–∞)**
–û–±–Ω–æ–≤–∏—Ç—å OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é:
- –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∫–æ–º–ø–∞–Ω–∏—è–º–∏
- –û–±–Ω–æ–≤–∏—Ç—å —Å—Ö–µ–º—ã User

---

## üìà –î–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –æ–±—ä–µ–º–∞ —Ä–∞–±–æ—Ç

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –§–∞–π–ª–æ–≤ | –í—Ä–µ–º—è (—á–∞—Å—ã) | –°–ª–æ–∂–Ω–æ—Å—Ç—å |
|-----------|--------|--------------|-----------|
| **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** | 3 | 3-4 | –°—Ä–µ–¥–Ω—è—è |
| **–ú–æ–¥–µ–ª–∏** | 3 | 2-3 | –°—Ä–µ–¥–Ω—è—è |
| **API –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã** | 7 | 8-10 | –í—ã—Å–æ–∫–∞—è |
| **Filament Resources** | 15 | 10-12 | –í—ã—Å–æ–∫–∞—è |
| **Filament Pages** | 5 | 3-4 | –°—Ä–µ–¥–Ω—è—è |
| **Policies** | 2 | 2-3 | –°—Ä–µ–¥–Ω—è—è |
| **–≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã** | 2 | 2 | –ù–∏–∑–∫–∞—è |
| **Factories/Seeders** | 3 | 2 | –ù–∏–∑–∫–∞—è |
| **–¢–µ—Å—Ç—ã** | 10+ | 5-6 | –°—Ä–µ–¥–Ω—è—è |
| **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** | 3 | 1-2 | –ù–∏–∑–∫–∞—è |
| **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞** | - | 5-8 | –í—ã—Å–æ–∫–∞—è |
| **–ò–¢–û–ì–û:** | **~50** | **43-54 —á–∞—Å–∞** | **–í—ã—Å–æ–∫–∞—è** |

---

## ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏ –ø—Ä–æ–±–ª–µ–º—ã

### **1. –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**
- –°—Ç–∞—Ä—ã–π –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `$user->company_id` –Ω–∞–ø—Ä—è–º—É—é
- –ù—É–∂–Ω–æ –æ–±–µ—Å–ø–µ—á–∏—Ç—å accessors –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- –†–∏—Å–∫ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –º–µ—Å—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### **2. –°–ª–æ–∂–Ω–æ—Å—Ç—å –ª–æ–≥–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞**
- –£—Å–ª–æ–∂–Ω—è–µ—Ç—Å—è –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤
- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –º–µ—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–∞
- –†–∏—Å–∫ —Å–æ–∑–¥–∞–Ω–∏—è –¥—ã—Ä –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### **3. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
- N+1 –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Å–≤—è–∑–µ–π
- –ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å eager loading
- –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î

### **4. –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–≤—è–∑–∏
- –†–∏—Å–∫ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏
- –ù—É–∂–µ–Ω rollback –ø–ª–∞–Ω

### **5. UX —Å–ª–æ–∂–Ω–æ—Å—Ç—å**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–æ–º–ø–∞–Ω–∏—è–º–∏
- –ù—É–∂–µ–Ω UI –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∫–æ–º–ø–∞–Ω–∏–∏
- –ú–æ–∂–µ—Ç –∑–∞–ø—É—Ç–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

## üí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### **–í–∞—Ä–∏–∞–Ω—Ç 1: –û—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)**
**–ü–ª—é—Å—ã:**
- –ù–µ—Ç –∑–∞—Ç—Ä–∞—Ç –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É
- –°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–±–∏–ª—å–Ω–∞ –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞
- –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ –¥–æ—Å—Ç—É–ø–∞

**–ú–∏–Ω—É—Å—ã:**
- –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏
- –ù—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –¥—É–±–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–æ–º–ø–∞–Ω–∏—è—Ö

### **–í–∞—Ä–∏–∞–Ω—Ç 2: –†–æ–ª–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–º–ø–∞–Ω–∏–π**
–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π, –Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –æ–¥–∏–Ω –∞–∫—Ç–∏–≤–Ω—ã–π —Å–∫–ª–∞–¥:
```
User ‚Üê‚Üí Companies (many-to-many)
User ‚Üí Warehouse (one-to-one, –∞–∫—Ç–∏–≤–Ω—ã–π —Å–∫–ª–∞–¥)
```
**–ü–ª—é—Å—ã:**
- –ú–µ–Ω—å—à–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–¥–∞
- –ü—Ä–æ—â–µ –ª–æ–≥–∏–∫–∞ –¥–æ—Å—Ç—É–ø–∞
- –õ–µ–≥—á–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å

**–ú–∏–Ω—É—Å—ã:**
- –í—Å–µ –µ—â–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ–¥–Ω–∏–º –∞–∫—Ç–∏–≤–Ω—ã–º —Å–∫–ª–∞–¥–æ–º

### **–í–∞—Ä–∏–∞–Ω—Ç 3: –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (—Ç–µ–∫—É—â–µ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ)**
**–ü–ª—é—Å—ã:**
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–∏–±–∫–æ—Å—Ç—å
- –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å = –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –Ω—É–∂–Ω—ã–º –∫–æ–º–ø–∞–Ω–∏—è–º/—Å–∫–ª–∞–¥–∞–º

**–ú–∏–Ω—É—Å—ã:**
- –í—ã—Å–æ–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å
- –ë–æ–ª—å—à–æ–π –æ–±—ä–µ–º —Ä–∞–±–æ—Ç—ã
- –†–∏—Å–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### **–ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å:**

1. **–ù–∞—á–∞—Ç—å —Å MVP (–í–∞—Ä–∏–∞–Ω—Ç 2):**
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏
   - –û—Å—Ç–∞–≤–∏—Ç—å –æ–¥–∏–Ω –∞–∫—Ç–∏–≤–Ω—ã–π —Å–∫–ª–∞–¥
   - ~20-25 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã
   - –ú–µ–Ω—å—à–µ —Ä–∏—Å–∫–æ–≤

2. **–ü–æ—ç—Ç–∞–ø–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
   - **–§–∞–∑–∞ 1:** –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–æ–¥–µ–ª–∏ (1 –Ω–µ–¥–µ–ª—è)
   - **–§–∞–∑–∞ 2:** API –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (1-1.5 –Ω–µ–¥–µ–ª–∏)
   - **–§–∞–∑–∞ 3:** Filament –∞–¥–º–∏–Ω–∫–∞ (1.5 –Ω–µ–¥–µ–ª–∏)
   - **–§–∞–∑–∞ 4:** –¢–µ—Å—Ç—ã –∏ –æ—Ç–ª–∞–¥–∫–∞ (1 –Ω–µ–¥–µ–ª—è)
   - **–ò—Ç–æ–≥–æ:** 4.5-5 –Ω–µ–¥–µ–ª—å

3. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —à–∞–≥–∏:**
   - –ù–∞–ø–∏—Å–∞—Ç—å –ø–æ–ª–Ω–æ–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ
   - –°–æ–∑–¥–∞—Ç—å backup –ë–î –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π
   - –ù–∞–ø–∏—Å–∞—Ç—å –∞–≤—Ç–æ—Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
   - –ü—Ä–æ–≤–µ—Å—Ç–∏ security audit –ø–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### **–ï—Å–ª–∏ –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
**–†–ï–ö–û–ú–ï–ù–î–£–Æ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–∫—É—â—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É!**
- –°–æ–∑–¥–∞–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SSO –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –≤—Ö–æ–¥–∞
- –ù–∞–º–Ω–æ–≥–æ –ø—Ä–æ—â–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ

---

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π –≤ –ø—Ä–æ—Ñ–∏–ª—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ **—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –≤–æ–∑–º–æ–∂–Ω–æ**, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç:

- ‚úÖ **~45-54 —á–∞—Å–∞** —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ **~50 —Ñ–∞–π–ª–æ–≤** –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è
- ‚úÖ **–í—ã—Å–æ–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å** —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚ö†Ô∏è **–°—Ä–µ–¥–Ω–∏–µ —Ä–∏—Å–∫–∏** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
- üí∞ **–í—ã—Å–æ–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å** —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û—Ü–µ–Ω–∏—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –ï—Å–ª–∏ –æ–Ω–∞ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞, –ª—É—á—à–µ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–∫—É—â—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É "–æ–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å = –æ–¥–Ω–∞ –∫–æ–º–ø–∞–Ω–∏—è + –æ–¥–∏–Ω —Å–∫–ª–∞–¥" –∫–∞–∫ –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–µ –∏ –Ω–∞–¥–µ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.

–ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –∫—Ä–∏—Ç–∏—á–Ω–∞ - –Ω–∞—á–∞—Ç—å —Å MVP (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏, –æ–¥–∏–Ω –∞–∫—Ç–∏–≤–Ω—ã–π —Å–∫–ª–∞–¥) –∏ –æ—Ü–µ–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–µ–¥ –ø–æ–ª–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π.

