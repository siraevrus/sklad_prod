# Исправление экспорта приемок в Excel

## Проблема
Кнопка "Экспорт в Excel" на странице приемок (`/admin/receipts`) не работала и открывала пустую страницу.

## Причина
Кнопка пыталась использовать несуществующий маршрут Filament для страницы экспорта, которая не была правильно зарегистрирована.

## Решение
Создан новый контроллер `ReceiptExportController` по аналогии с существующими контроллерами экспорта для продаж и товаров.

### Созданные файлы:
1. **app/Http/Controllers/ReceiptExportController.php** - контроллер для экспорта приемок в CSV/Excel
2. **tests/Feature/ReceiptExportTest.php** - тесты для проверки функциональности экспорта

### Изменённые файлы:
1. **routes/web.php** - добавлен маршрут `/receipts/export`
2. **app/Filament/Resources/ReceiptResource/Pages/ListReceipts.php** - кнопка теперь использует правильный маршрут
3. **app/Filament/Resources/ReceiptResource.php** - удалена регистрация страницы экспорта
4. **app/Filament/Resources/ReceiptResource/Pages/ExportReceipts.php** - упрощён код (удалено дублирование)

## Функциональность
Экспорт создаёт CSV файл с кодировкой UTF-8 (с BOM для корректного отображения в Excel) со следующими колонками:
- ID
- Наименование
- Склад
- Производитель
- Шаблон
- Количество
- Объем
- Номер транспорта
- Место отгрузки
- Дата отгрузки
- Ожидаемая дата
- Статус
- Сотрудник
- Дата создания

## Права доступа
- **Администратор**: видит все приемки
- **Оператор/Работник склада**: видит только приемки своего склада
- **Гость**: перенаправляется на страницу входа

## Использование
1. Перейти на страницу приемок: `/admin/receipts`
2. Нажать кнопку "Экспорт в Excel" в правом верхнем углу
3. Файл автоматически скачается с именем `receipts_YYYY-MM-DD.csv`

## Маршрут
```
GET /receipts/export
```

## Тестирование
Созданы тесты в `tests/Feature/ReceiptExportTest.php`:
- `test_admin_can_export_receipts` - проверка экспорта для администратора
- `test_operator_can_export_receipts_from_their_warehouse` - проверка экспорта для оператора
- `test_guest_cannot_export_receipts` - проверка защиты от неавторизованного доступа

## Развёртывание
После развёртывания на сервере необходимо:
1. Очистить кэш маршрутов: `php artisan route:clear`
2. Очистить кэш Filament: `php artisan filament:optimize-clear`

