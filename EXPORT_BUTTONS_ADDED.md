# Добавлены кнопки экспорта в Excel

## Изменения

Добавлены кнопки "Экспорт в Excel" в следующие разделы:

### 1. Раздел "Реализация" (Sales)
- **Страница**: `/admin/sales`
- **Файл**: `app/Filament/Resources/SaleResource/Pages/ListSales.php`
- **Маршрут**: `/sales/export` (уже существовал)
- **Контроллер**: `app/Http/Controllers/SaleExportController.php`

### 2. Раздел "Поступление товара" (Products)
- **Страница**: `/admin/products`
- **Файл**: `app/Filament/Resources/ProductResource/Pages/ListProducts.php`
- **Маршрут**: `/products/export` (уже существовал)
- **Контроллер**: `app/Http/Controllers/ProductExportController.php`

### 3. Раздел "Приемка товаров" (Receipts)
- **Страница**: `/admin/receipts`
- **Файл**: `app/Filament/Resources/ReceiptResource/Pages/ListReceipts.php`
- **Маршрут**: `/receipts/export` (создан новый)
- **Контроллер**: `app/Http/Controllers/ReceiptExportController.php` (создан новый)

## Улучшения контроллеров экспорта

Все контроллеры экспорта обновлены для улучшенной совместимости с Excel:

### Изменения:
1. **UTF-8 с BOM** - добавлен BOM (Byte Order Mark) для корректного отображения кириллицы в Excel
2. **Разделитель ";"** - используется точка с запятой вместо запятой для лучшей совместимости с русской версией Excel
3. **Формат даты** - изменён на `d.m.Y` (например, 24.10.2025) вместо `Y-m-d`
4. **Округление объёма** - объём округляется до 3 знаков после запятой

## Экспортируемые данные

### Реализация (Sales)
- ID, Номер продажи, Товар, Склад, Клиент
- Количество, Цена за ед., Сумма без НДС, НДС, Общая сумма
- Способ оплаты, Статус оплаты
- Дата продажи, Дата доставки, Продавец, Заметки

### Поступление товара (Products)
- ID, Название, Описание, Шаблон, Склад, Производитель
- Количество, Объем (м³)
- Дата поступления, Статус, Сотрудник, Дата создания

### Приемка товаров (Receipts)
- ID, Наименование, Склад, Производитель, Шаблон
- Количество, Объем, Номер транспорта
- Место отгрузки, Дата отгрузки, Ожидаемая дата
- Статус, Сотрудник, Дата создания

## Права доступа

Все экспорты учитывают права доступа:
- **Администратор**: видит все записи
- **Оператор/Работник склада**: видит только записи своего склада/компании

## Использование

1. Перейти на соответствующую страницу
2. Нажать кнопку "Экспорт в Excel" в правом верхнем углу
3. Файл автоматически скачается с именем `{type}_YYYY-MM-DD.csv`

## Развёртывание

После развёртывания на сервере необходимо:
```bash
php artisan route:clear
php artisan filament:optimize-clear
php artisan config:clear
php artisan view:clear
```

## Тестирование

Проверить работу кнопок на страницах:
- ✅ https://warehouse.expwood.ru/admin/sales
- ✅ https://warehouse.expwood.ru/admin/products
- ✅ https://warehouse.expwood.ru/admin/receipts

