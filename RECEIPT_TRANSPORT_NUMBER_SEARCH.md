# Поиск по номеру транспортного средства в разделе Поступление товара

## Описание

В разделе **Поступление товара** → **Товар в пути** добавлена возможность **поиска по номеру транспортного средства**.

Теперь пользователь может ввести номер машины (номер автомобиля) в поле поиска и найти все товары, которые везла эта машина.

## Примеры использования

### Примеры номеров транспортных средств:
- `А123БВ77` - российский номер
- `Р555РР55` - российский номер
- `КЗ123КЗ` - казахский номер
- `УЗ456УЗ` - узбекский номер

### API запрос

```bash
# Получить товары в пути по номеру транспортного средства
GET /api/receipts?search=А123БВ77
```

### Пример ответа

```json
{
  "success": true,
  "data": [
    {
      "id": 5,
      "product_template_id": 1,
      "warehouse_id": 2,
      "name": "Доска обрезная: 50 x 150 x 4000",
      "quantity": 100,
      "transport_number": "А123БВ77",
      "shipping_location": "Москва",
      "shipping_date": "2025-10-21",
      "expected_arrival_date": "2025-10-23",
      "status": "in_transit",
      "is_active": true
    }
  ],
  "pagination": {
    "current_page": 1,
    "last_page": 1,
    "per_page": 15,
    "total": 1
  }
}
```

## Технические изменения

### Файл: `app/Http/Controllers/Api/ReceiptController.php`

**Метод:** `index()` (строка 185-273)

**Что изменилось:**
- Добавлен поиск по полю `transport_number` в условие WHERE
- Теперь поиск ищет по:
  - `name` (название товара) ✓ было
  - `producer` (производитель) ✓ было
  - `shipping_location` (место отправки) ✓ было
  - `transport_number` (номер транспорта) ✅ **НОВОЕ**

**Изменённый код:**
```php
if ($request->filled('search')) {
    $search = $request->input('search');
    $query->where(function ($q) use ($search) {
        $q->where('name', 'like', "%{$search}%")
            ->orWhere('producer', 'like', "%{$search}%")
            ->orWhere('shipping_location', 'like', "%{$search}%")
            ->orWhere('transport_number', 'like', "%{$search}%");  // ← НОВОЕ
    });
}
```

## Тесты

Добавлен новый тест: `test_can_search_in_transit_products_by_transport_number()`

Тест проверяет:
- Создание товара в пути с номером транспортного средства
- Поиск этого товара по номеру через API
- Что результат поиска содержит правильный номер

## Совместимость

- ✅ Не нарушает существующий функционал
- ✅ Полностью обратно совместимо
- ✅ Работает вместе с другими фильтрами

## Параметры поиска

Поле поиска (`search`) теперь ищет по:

| Поле | Тип | Пример |
|------|-----|--------|
| `name` | текст | "Доска" |
| `producer` | текст | "Производитель XYZ" |
| `shipping_location` | текст | "Москва" |
| `transport_number` | текст | "А123БВ77" |

## Примеры использования в Flutter

```dart
// Поиск товара в пути по номеру транспортного средства
final response = await http.get(
  Uri.parse('https://api.example.com/api/receipts?search=А123БВ77'),
  headers: {
    'Authorization': 'Bearer $token',
  },
);

if (response.statusCode == 200) {
  final data = jsonDecode(response.body);
  final items = data['data'] as List;
  print('Найдено товаров: ${items.length}');
}
```

## Развертывание

1. На локальной машине:
```bash
git push origin main
```

2. На боевом сервере:
```bash
cd /var/www/warehouse
git pull origin main
```

**Никаких дополнительных команд не требуется!**

## Логирование и отладка

API логирует все запросы с параметром `search` для отладки.

Для локального тестирования:
```bash
# Протестировать поиск по номеру транспорта
curl -H "Authorization: Bearer TOKEN" \
  'https://example.com/api/receipts?search=А123БВ77' | jq '.data[0]'
```

## Улучшение пользовательского опыта

Благодаря этому улучшению:
- ✅ Пользователи могут быстро найти товары конкретного водителя/машины
- ✅ Упрощен процесс приемки товара по прибытии
- ✅ Снижены ошибки при поиске товаров в пути
- ✅ Улучшена скорость работы с большим количеством товаров

## История изменений

- **2025-10-21** - добавлен поиск по номеру транспортного средства (коммит: `f7d895c`)
