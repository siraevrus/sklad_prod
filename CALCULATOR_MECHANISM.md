# –ú–µ—Ö–∞–Ω–∏–∑–º –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ Sklad

## üìã –û–±–∑–æ—Ä

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–µ—Å—Ç–∞ –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Ä–∞—Å—á—ë—Ç–æ–º –æ–±—ä—ë–º–∞ —Ç–æ–≤–∞—Ä–æ–≤:
1. **–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞** (ReceiptResource) - —Ä–∞—Å—á—ë—Ç –æ–±—ä—ë–º–∞ –ø–æ —Ñ–æ—Ä–º—É–ª–µ
2. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è** (SaleResource) - —Ä–∞—Å—á—ë—Ç –æ–±—â–µ–π —Å—É–º–º—ã –ø—Ä–æ–¥–∞–∂–∏

–ú–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ **Filament** (SDUI —Ñ—Ä–µ–π–º–≤–æ—Ä–∫) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Livewire** –¥–ª—è —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

---

## üßÆ –ß–ê–°–¢–¨ 1: –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† –û–ë–™–Å–ú–ê –í "–ü–û–°–¢–£–ü–õ–ï–ù–ò–ï –¢–û–í–ê–†–ê"

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
ReceiptResource (Filament)
    ‚îú‚îÄ> Repeater (–¢–æ–≤–∞—Ä—ã –≤ –ø—Ä–∏—ë–º–∫–µ)
    ‚îÇ   ‚îú‚îÄ> Select: product_template_id (–í—ã–±–æ—Ä —à–∞–±–ª–æ–Ω–∞)
    ‚îÇ   ‚îú‚îÄ> TextInput: quantity (–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ)
    ‚îÇ   ‚îú‚îÄ> TextInput: attribute_* (–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏)
    ‚îÇ   ‚îî‚îÄ> TextInput: calculated_volume (–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å—á—ë—Ç–∞ - readonly)
    ‚îÇ
    ‚îî‚îÄ> ProductAttributeCalculator (–ö–ª–∞—Å—Å-–ø–æ–º–æ—â–Ω–∏–∫)
        ‚îî‚îÄ> ProductTemplate::testFormula()
            ‚îî‚îÄ> –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ
```

### –ü—Ä–æ—Ü–µ—Å—Å –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö

#### –®–∞–≥ 1: –í—ã–±–æ—Ä —à–∞–±–ª–æ–Ω–∞ —Ç–æ–≤–∞—Ä–∞

```php
Select::make('product_template_id')
    ->live()
    ->afterStateUpdated(function (Set $set) {
        $set('name', '');
        $set('calculated_volume', null);
    })
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –ü—Ä–∏ –≤—ã–±–æ—Ä–µ —à–∞–±–ª–æ–Ω–∞ –æ—á–∏—â–∞—é—Ç—Å—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
- –û—á–∏—â–∞–µ—Ç—Å—è –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–π –æ–±—ä—ë–º
- Triggering –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª–µ–π

#### –®–∞–≥ 2: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫

```php
Grid::make(2)->schema(function (Get $get) {
    $templateId = $get('product_template_id');
    $template = ProductTemplate::find($templateId);
    
    // –î–ª—è –∫–∞–∂–¥–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø–æ–ª–µ
    foreach ($template->attributes as $attribute) {
        $fieldName = "attribute_{$attribute->variable}";
        
        // –¢–∏–ø –ø–æ–ª—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç type —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
        switch ($attribute->type) {
            case 'number':
                // TextInput —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π regex
                // live(debounce: 400) - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å–ø—É—Å—Ç—è 400ms –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞
                break;
            case 'text':
                // TextInput –±–µ–∑ —á–∏—Å–ª–æ–≤—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
                break;
            case 'select':
                // Select —Å –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º–∏ –æ–ø—Ü–∏—è–º–∏
                break;
        }
    }
})
```

**–ö–ª—é—á–µ–≤—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞:**
- `->live()` - —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –≤–≤–æ–¥–µ
- `->debounce(400)` - –∑–∞–¥–µ—Ä–∂–∫–∞ 400ms –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- `->afterStateUpdated()` - –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é —Ä–∞—Å—á—ë—Ç–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏

#### –®–∞–≥ 3: –†–∞—Å—á—ë—Ç –æ–±—ä—ë–º–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–ª—è

```php
->afterStateUpdated(function (Set $set, Get $get) {
    self::calculateVolumeForItem($set, $get);
})

// –ú–µ—Ç–æ–¥ –≤ ReceiptResource:
private static function calculateVolumeForItem(Set $set, Get $get): void
{
    $templateId = $get('product_template_id');
    $quantity = $get('quantity');
    $formData = $get();
    
    // –ü–µ—Ä–µ–¥–∞—ë–º –≤ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä
    ProductAttributeCalculator::calculateAndUpdate($set, $formData, $templateId, $quantity);
}
```

### –Ø–¥—Ä–æ: ProductAttributeCalculator

–§–∞–π–ª: `app/Support/ProductAttributeCalculator.php`

#### –ú–µ—Ç–æ–¥: `calculateAndUpdate()`

```php
public static function calculateAndUpdate(
    Set $set, 
    array $formData, 
    int $templateId, 
    mixed $quantity = null
): void {
    
    // 1. –í–∞–ª–∏–¥–∞—Ü–∏—è templateId
    if (!$templateId) {
        $set('calculated_volume', '–í—ã–±–µ—Ä–∏—Ç–µ —à–∞–±–ª–æ–Ω');
        return;
    }
    
    // 2. –ü–æ–ª—É—á–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ –∏–∑ –ë–î (—Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º)
    $template = self::getTemplateFromCache($templateId);
    if (!$template) {
        $set('calculated_volume', '–®–∞–±–ª–æ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω');
        return;
    }
    
    // 3. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏–∑ formData
    $attributes = self::extractAttributes($formData);
    // –†–µ–∑—É–ª—å—Ç–∞—Ç: ['length' => 10, 'width' => 5, 'height' => 2]
    
    // 4. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ñ–æ—Ä–º—É–ª–∞—Ö)
    if ($quantity !== null && is_numeric($quantity) && $quantity > 0) {
        $attributes['quantity'] = (int) $quantity;
    }
    
    // 5. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è
    $generatedName = self::generateName($template, $attributes);
    if ($generatedName) {
        $set('name', $generatedName);
    }
    // –ü—Ä–∏–º–µ—Ä: "–î–æ—Å–∫–∞: 10 x 5 x 2, –°–æ—Å–Ω–∞"
    
    // 6. –†–∞—Å—á—ë—Ç –æ–±—ä—ë–º–∞
    self::calculateVolume($set, $template, $attributes);
}
```

#### –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥: `extractAttributes()`

```php
private static function extractAttributes(array $formData): array
{
    $attributes = [];
    
    foreach ($formData as $key => $value) {
        // –ò—â–µ–º –∫–ª—é—á–∏ –≤–∏–¥–∞: attribute_length, attribute_width
        if (str_starts_with($key, 'attribute_') && $value !== null && $value !== '') {
            $attributeName = str_replace('attribute_', '', $key);
            
            // –í–ê–ñ–ù–û: –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∑–∞–ø—è—Ç—ã–µ –Ω–∞ —Ç–æ—á–∫–∏!
            // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–≤–µ—Å—Ç–∏ "2,5" - –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ "2.5"
            $normalizedValue = is_string($value) 
                ? str_replace(',', '.', $value) 
                : $value;
            
            $attributes[$attributeName] = $normalizedValue;
        }
    }
    
    return $attributes;
}
// –í—Ö–æ–¥: ['attribute_length' => '10,5', 'attribute_width' => '5', 'field_other' => 'skip']
// –í—ã—Ö–æ–¥: ['length' => '10.5', 'width' => '5']
```

#### –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥: `generateName()`

```php
private static function generateName(ProductTemplate $template, array $attributes): ?string
{
    if (empty($template->attributes)) {
        return null;
    }
    
    $formulaParts = [];    // –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, —É—á–∞—Å—Ç–≤—É—é—â–∏–µ –≤ —Ñ–æ—Ä–º—É–ª–µ
    $regularParts = [];    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
    
    foreach ($template->attributes as $templateAttribute) {
        $attributeKey = $templateAttribute->variable;
        
        if (isset($attributes[$attributeKey]) && $attributes[$attributeKey] !== null) {
            if ($templateAttribute->is_in_formula) {
                // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Ñ–æ—Ä–º—É–ª—É: "10, 5, 2"
                $formulaParts[] = $attributes[$attributeKey];
            } else {
                // –î–æ–±–∞–≤–ª—è–µ–º –≤ –¥–æ–ø. –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é: "–°–æ—Å–Ω–∞, –°—É—à—ë–Ω–Ω–∞—è"
                $regularParts[] = $attributes[$attributeKey];
            }
        }
    }
    
    // –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è
    $templateName = $template->name ?? '–¢–æ–≤–∞—Ä';
    $generatedName = $templateName;
    
    if (!empty($formulaParts)) {
        $generatedName .= ': ' . implode(' x ', $formulaParts);
        // –†–µ–∑—É–ª—å—Ç–∞—Ç: "–î–æ—Å–∫–∞: 10 x 5 x 2"
    }
    
    if (!empty($regularParts)) {
        $generatedName .= !empty($formulaParts)
            ? ', ' . implode(', ', $regularParts)
            : ': ' . implode(', ', $regularParts);
        // –†–µ–∑—É–ª—å—Ç–∞—Ç: "–î–æ—Å–∫–∞: 10 x 5 x 2, –°–æ—Å–Ω–∞, –°—É—à—ë–Ω–Ω–∞—è"
    }
    
    return $generatedName;
}
```

#### –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥: `calculateVolume()`

```php
private static function calculateVolume(
    Set $set, 
    ProductTemplate $template, 
    array $attributes
): void {
    
    // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ñ–æ—Ä–º—É–ª—ã
    if (!$template->formula) {
        $set('calculated_volume', '–§–æ—Ä–º—É–ª–∞ –Ω–µ –∑–∞–¥–∞–Ω–∞');
        return;
    }
    
    // 2. –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∫–∞ —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π > 0
    $numericAttributes = [];
    foreach ($attributes as $key => $value) {
        if (is_numeric($value) && $value > 0) {
            $numericAttributes[$key] = (float) $value;
        }
    }
    
    // 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞
    if (empty($numericAttributes)) {
        $set('calculated_volume', '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —á–∏—Å–ª–æ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏');
        return;
    }
    
    // 4. –í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–æ—Ä–º—É–ª—ã –∏–∑ –º–æ–¥–µ–ª–∏
    $testResult = $template->testFormula($numericAttributes);
    
    // 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    if ($testResult['success']) {
        $result = $testResult['result'];
        $set('calculated_volume', $result);
        
        // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ debug —Ä–µ–∂–∏–º–µ
        if (config('app.debug')) {
            Log::debug('Volume calculated successfully', [
                'template' => $template->name,
                'attributes' => $numericAttributes,
                'result' => $result,
            ]);
        }
    } else {
        // –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏
        $set('calculated_volume', '–û—à–∏–±–∫–∞ —Ñ–æ—Ä–º—É–ª—ã: ' . ($testResult['error'] ?? '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
        Log::warning('Volume calculation failed', [
            'template' => $template->name,
            'attributes' => $numericAttributes,
            'error' => $testResult['error'] ?? 'Unknown',
        ]);
    }
}
```

### –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª—ã: ProductTemplate::testFormula()

–§–∞–π–ª: `app/Models/ProductTemplate.php`

```php
public function testFormula(array $values = []): array
{
    if (!$this->formula) {
        return ['success' => false, 'error' => '–§–æ—Ä–º—É–ª–∞ –Ω–µ –∑–∞–¥–∞–Ω–∞', 'result' => null];
    }
    
    try {
        // 1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑ —Ñ–æ—Ä–º—É–ª—ã
        $variables = $this->extractVariablesFromFormula();
        // –î–ª—è —Ñ–æ—Ä–º—É–ª—ã "length * width * height" –ø–æ–ª—É—á–∏–º: ['length', 'width', 'height']
        
        // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
        $missingVariables = array_diff($variables, array_keys($values));
        if (!empty($missingVariables)) {
            // –ü–æ–ª—É—á–∞–µ–º —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
            $missingVariableNames = [];
            foreach ($missingVariables as $variable) {
                $attribute = $this->attributes()->where('variable', $variable)->first();
                if ($attribute) {
                    $missingVariableNames[] = $attribute->name;
                }
            }
            
            return [
                'success' => false,
                'error' => implode(', ', $missingVariableNames),
                'result' => null,
            ];
        }
        
        // 3. –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ —Ñ–æ—Ä–º—É–ª—É
        $expression = $this->formula;
        foreach ($values as $variable => $value) {
            if (is_numeric($value)) {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º regex –¥–ª—è —Ç–æ—á–Ω–æ–π –∑–∞–º–µ–Ω—ã —Å–ª–æ–≤ (–Ω–µ —á–∞—Å—Ç–µ–π —Å–ª–æ–≤)
                $pattern = '/\b' . preg_quote($variable, '/') . '\b/';
                $expression = preg_replace($pattern, $value, $expression);
            }
        }
        // –î–ª—è formula "length * width * height" –∏ values {length: 10, width: 5, height: 2}
        // —Ä–µ–∑—É–ª—å—Ç–∞—Ç: "10 * 5 * 2"
        
        Log::info('Formula calculation', [
            'original_formula' => $this->formula,
            'values' => $values,
            'final_expression' => $expression,
        ]);
        
        // 4. –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
        $result = $this->evaluateExpression($expression);
        
        return [
            'success' => true,
            'error' => null,
            'result' => round($result, 3),
            // –î–ª—è –ø—Ä–∏–º–µ—Ä–∞: 100 (10 * 5 * 2)
        ];
    } catch (\Exception $e) {
        return [
            'success' => false,
            'error' => '–û—à–∏–±–∫–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è: ' . $e->getMessage(),
            'result' => null,
        ];
    }
}
```

#### –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ: `evaluateExpression()`

```php
private function evaluateExpression(string $expression): float
{
    // 1. –£–¥–∞–ª—è–µ–º –ø—Ä–æ–±–µ–ª—ã
    $expression = str_replace(' ', '', $expression);
    
    // 2. –í–∞–ª–∏–¥–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (—Ç–æ–ª—å–∫–æ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏!)
    if (!preg_match('/^[0-9+\-*\/\(\)\.]+$/', $expression)) {
        throw new \Exception('–í—ã—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Å–∏–º–≤–æ–ª—ã');
    }
    
    // 3. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–∞—Ä—Å–µ—Ä —Å —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏–π)
    try {
        $result = $this->parseExpression($expression);
        
        if (!is_numeric($result)) {
            throw new \Exception('–†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —á–∏—Å–ª–æ–º');
        }
        
        return (float) $result;
        
    } catch (\DivisionByZeroError $e) {
        throw new \Exception('–î–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–ª—å');
    } catch (\Exception $e) {
        throw new \Exception('–û—à–∏–±–∫–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤—ã—Ä–∞–∂–µ–Ω–∏—è: ' . $e->getMessage());
    }
}
```

#### –ü–∞—Ä—Å–µ—Ä –≤—ã—Ä–∞–∂–µ–Ω–∏–π: `parseExpression()`

```php
private function parseExpression(string $expression): float
{
    // 1. –£–¥–∞–ª—è–µ–º –ø—Ä–æ–±–µ–ª—ã
    $expression = preg_replace("/\s+/", '', $expression);
    
    // 2. –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–∫–æ–±–æ–∫ (–±–∞–ª–∞–Ω—Å –æ—Ç–∫—Ä—ã—Ç–∏—è/–∑–∞–∫—Ä—ã—Ç–∏—è)
    if (!$this->validateParentheses($expression)) {
        throw new \Exception('–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∫–æ–±–æ–∫');
    }
    
    // 3. –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –æ–ø–µ—Ä–∞—Ü–∏–π
    return $this->evaluateExpressionRecursive($expression);
}

// –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–æ–±–ª—é–¥–∞–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
// 1. –°–∫–æ–±–∫–∏ ()
// 2. –£–º–Ω–æ–∂–µ–Ω–∏–µ (*) –∏ –¥–µ–ª–µ–Ω–∏–µ (/)
// 3. –°–ª–æ–∂–µ–Ω–∏–µ (+) –∏ –≤—ã—á–∏—Ç–∞–Ω–∏–µ (-)
// 
// –î–ª—è "2 + 3 * 4" –ø–æ–ª—É—á–∏–º 14, –∞ –Ω–µ 20
```

---

## üí∞ –ß–ê–°–¢–¨ 2: –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† –°–£–ú–ú–´ –í "–†–ï–ê–õ–ò–ó–ê–¶–ò–Ø"

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
SaleResource (Filament)
    ‚îú‚îÄ> TextInput: cash_amount (–°—É–º–º–∞ –Ω–∞–ª–∏—á–Ω—ã–º–∏)
    ‚îú‚îÄ> TextInput: nocash_amount (–°—É–º–º–∞ –±–µ–∑–Ω–∞–ª–∏—á–Ω—ã–º–∏)
    ‚îú‚îÄ> TextInput: total_price (–ò—Ç–æ–≥–æ - readonly, calculated)
    ‚îÇ
    ‚îî‚îÄ> calculateTotalPrice() (–ú–µ—Ç–æ–¥ –∫–ª–∞—Å—Å–∞)
```

### –ü—Ä–æ—Ü–µ—Å—Å –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö

#### –§–æ—Ä–º–∞ –≤ SaleResource

```php
Grid::make(5)->schema([
    // –ü–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü
    TextInput::make('cash_amount')
        ->label('–°—É–º–º–∞ (–Ω–∞–ª)')
        ->numeric()
        ->required()
        ->mask(RawJs::make('$number($input, { 
            decimalPlaces: 2, 
            thousandsSeparator: " ", 
            decimalSeparator: "," 
        })'))
        ->live(onBlur: true)  // –û–±–Ω–æ–≤–ª—è–µ—Ç –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Ñ–æ–∫—É—Å–∞
        ->afterStateUpdated(function (Set $set, Get $get) {
            static::calculateTotalPrice($set, $get);
        }),
    
    TextInput::make('nocash_amount')
        ->label('–°—É–º–º–∞ (–±–µ–∑–Ω–∞–ª)')
        ->numeric()
        ->required()
        ->mask(RawJs::make('$number($input, { 
            decimalPlaces: 2, 
            thousandsSeparator: " ", 
            decimalSeparator: "," 
        })'))
        ->live(onBlur: true)
        ->afterStateUpdated(function (Set $set, Get $get) {
            static::calculateTotalPrice($set, $get);
        }),
    
    // –í—Ç–æ—Ä–æ–π —Å—Ç–æ–ª–±–µ—Ü
    TextInput::make('total_price')
        ->label('–û–±—â–∞—è —Å—É–º–º–∞')
        ->numeric()
        ->disabled()  // –¢–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è
        ->required(),
]);
```

#### –ú–µ—Ç–æ–¥ —Ä–∞—Å—á—ë—Ç–∞: `calculateTotalPrice()`

```php
private static function calculateTotalPrice(Set $set, Get $get): void
{
    // 1. –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π (–º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∑–∞–ø—è—Ç—ã–µ –≤–º–µ—Å—Ç–æ —Ç–æ—á–µ–∫)
    $cashRaw = (string) ($get('cash_amount') ?? '0');
    $nocashRaw = (string) ($get('nocash_amount') ?? '0');
    
    // 2. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è: –∑–∞–ø—è—Ç–∞—è -> —Ç–æ—á–∫–∞ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
    $cashAmount = (float) str_replace(',', '.', $cashRaw);
    $nocashAmount = (float) str_replace(',', '.', $nocashRaw);
    
    // 3. –†–∞—Å—á—ë—Ç —Å—É–º–º—ã
    $totalPrice = $cashAmount + $nocashAmount;
    
    // 4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    $set('total_price', $totalPrice);
    
    // 5. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    Log::info('Sale form: calculateTotalPrice', [
        'cash_amount' => $cashAmount,
        'nocash_amount' => $nocashAmount,
        'total_price' => $totalPrice,
    ]);
}
```

### –ú–∞—Å–∫–∞ –≤–≤–æ–¥–∞ (RawJs)

```javascript
// –ü—Ä–∏–º–µ—Ä –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è:
// –í–≤–æ–¥: "1000"
// –û—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è: "1 000,00" (—Å —Ç—ã—Å—è—á–∞–º–∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º)
// –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è: "1000" (—á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)

$number($input, {
    decimalPlaces: 2,          // –î–≤–∞ –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
    thousandsSeparator: " ",   // –ü—Ä–æ–±–µ–ª –∫–∞–∫ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å —Ç—ã—Å—è—á
    decimalSeparator: ","      // –ó–∞–ø—è—Ç–∞—è –∫–∞–∫ –¥–µ—Å—è—Ç–∏—á–Ω—ã–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
})
```

---

## üîÑ –ö–õ–Æ–ß–ï–í–´–ï –û–¢–õ–ò–ß–ò–Ø

### –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ vs –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

| –ê—Å–ø–µ–∫—Ç | –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è |
|--------|-----------|-----------|
| **–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** | –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ç–æ–≤–∞—Ä–∞ (–¥–ª–∏–Ω–∞, —à–∏—Ä–∏–Ω–∞, –≤—ã—Å–æ—Ç–∞, etc.) | –î–µ–Ω–µ–∂–Ω—ã–µ —Å—É–º–º—ã (–Ω–∞–ª–∏—á–Ω—ã–µ, –±–µ–∑–Ω–∞–ª–∏—á–Ω—ã–µ) |
| **–¢–∏–ø —Ä–∞—Å—á—ë—Ç–∞** | –§–æ—Ä–º—É–ª–∞ (–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ) | –ü—Ä–æ—Å—Ç–æ–µ —Å–ª–æ–∂–µ–Ω–∏–µ –¥–≤—É—Ö –ø–æ–ª–µ–π |
| **–†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** | `live(debounce: 400)` - –∑–∞–¥–µ—Ä–∂–∫–∞ 400ms | `live(debounce: 400)` - –∑–∞–¥–µ—Ä–∂–∫–∞ 400ms ‚ú® **–£–ù–ò–§–ò–¶–ò–†–û–í–ê–ù–û** |
| **–í—ã—á–∏—Å–ª–µ–Ω–∏—è** | –ü–∞—Ä—Å–µ—Ä –≤—ã—Ä–∞–∂–µ–Ω–∏–π –≤ `ProductTemplate::testFormula()` | –ü—Ä–æ—Å—Ç–æ–µ —Å–ª–æ–∂–µ–Ω–∏–µ float —á–∏—Å–µ–ª |
| **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω–∏** | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–∑ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ | –ù–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è |
| **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª–µ–π** | –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —à–∞–±–ª–æ–Ω–∞) | –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ |
| **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤–≤–æ–¥–∞** | str_replace(',', '.', $value) | str_replace(',', '.', $value) |

---

## üõ°Ô∏è –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

### –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞

1. **Regex –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ TextInput (—á–∏—Å–ª–æ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏):**
   ```php
   ->rules(['regex:/^\d*([.,]\d*)?$/'])
   ->validationMessages(['regex' => '–ü–æ–ª–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã –∏ –æ–¥–Ω—É –∑–∞–ø—è—Ç—É—é –∏–ª–∏ —Ç–æ—á–∫—É'])
   ```
   ‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω—ã: `10`, `10.5`, `10,5`
   ‚ùå –ó–∞–ø—Ä–µ—â–µ–Ω—ã: `abc`, `10,,5`, `10.5.2`

2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª:**
   ```php
   // –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –≤ –≤—ã—Ä–∞–∂–µ–Ω–∏–∏ —Ç–æ–ª—å–∫–æ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã
   if (!preg_match('/^[0-9+\-*\/\(\)\.]+$/', $expression)) {
       throw new \Exception('–í—ã—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Å–∏–º–≤–æ–ª—ã');
   }
   ```
   ‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω—ã: `10 * 5 + 2`, `(10 + 5) * 2`
   ‚ùå –ó–∞–ø—Ä–µ—â–µ–Ω—ã: `exec()`, `system()`, –ª—é–±–æ–π –∫–æ–¥

3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞ –≤–º–µ—Å—Ç–æ eval():**
   - –í `ReceiptResource::calculateVolumeForItem()` —Å—Ç–∞—Ä—ã–π –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª `eval()`
   - –í `ProductTemplate::testFormula()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä - **–±–µ–∑–æ–ø–∞—Å–Ω–µ–µ!**

---

## üìä –ü–†–ò–ú–ï–† –ü–û–õ–ù–û–ì–û –¶–ò–ö–õ–ê

### –°—Ü–µ–Ω–∞—Ä–∏–π: –ü—Ä–∏—ë–º –¥–æ—Å–∫–∏

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —à–∞–±–ª–æ–Ω:**
   ```
   –®–∞–±–ª–æ–Ω: "–î–æ—Å–∫–∞"
   –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏: length, width, height, wood_type
   –§–æ—Ä–º—É–ª–∞: "length * width * height / 1000"
   ```

2. **–°–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è:**
   ```
   ‚òê –î–ª–∏–Ω–∞ (—Å–º): [____]
   ‚òê –®–∏—Ä–∏–Ω–∞ (—Å–º): [____]
   ‚òê –í—ã—Å–æ—Ç–∞ (—Å–º): [____]
   ‚òê –¢–∏–ø –¥—Ä–µ–≤–µ—Å–∏–Ω—ã: [–≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫]
   ```

3. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ:**
   ```
   –î–ª–∏–Ω–∞: 200
   –®–∏—Ä–∏–Ω–∞: 50,5      ‚Üê –Ω–æ—Ç–∞—Ü–∏—è —Å –∑–∞–ø—è—Ç–æ–π
   –í—ã—Å–æ—Ç–∞: 2,5       ‚Üê –Ω–æ—Ç–∞—Ü–∏—è —Å –∑–∞–ø—è—Ç–æ–π
   –¢–∏–ø: –°–æ—Å–Ω–∞
   –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: 10
   ```

4. **–°–∏—Å—Ç–µ–º–∞ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç:**
   ```php
   $attributes = [
       'length' => 200,       // float
       'width' => 50.5,       // float - –∑–∞–ø—è—Ç–∞—è –∑–∞–º–µ–Ω–µ–Ω–∞
       'height' => 2.5,       // float - –∑–∞–ø—è—Ç–∞—è –∑–∞–º–µ–Ω–µ–Ω–∞
       'wood_type' => '–°–æ—Å–Ω–∞',
       'quantity' => 10
   ]
   ```

5. **–°–∏—Å—Ç–µ–º–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–º—è:**
   ```
   –®–∞–±–ª–æ–Ω: "–î–æ—Å–∫–∞: 200 x 50.5 x 2.5, –°–æ—Å–Ω–∞"
   ```

6. **–°–∏—Å—Ç–µ–º–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç –æ–±—ä—ë–º:**
   ```
   –§–æ—Ä–º—É–ª–∞: "length * width * height / 1000"
   –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞: "200 * 50.5 * 2.5 / 1000"
   –ü–∞—Ä—Å–∏–Ω–≥ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ: (200 * 50.5 * 2.5) / 1000 = 25.25
   –†–µ–∑—É–ª—å—Ç–∞—Ç: 25.25 –º¬≥
   ```

7. **–ü–æ–ª–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   ```
   –û–±—ä–µ–º: 25.250 –º¬≥
   ```

---

## üêõ –ò–ó–í–ï–°–¢–ù–´–ï –û–°–û–ë–ï–ù–ù–û–°–¢–ò –ò –ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### 1. –î–≤–æ–π–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å—á—ë—Ç–æ–≤ –≤ ReceiptResource

**–ü—Ä–æ–±–ª–µ–º–∞:** –í `ReceiptResource::calculateVolumeForItem()` —Å—Ç–∞—Ä—ã–π –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `eval()`:
```php
$result = eval("return $expression;");  // ‚ö†Ô∏è –£–Ø–ó–í–ò–ú–û–°–¢–¨!
```

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `ProductAttributeCalculator` –∏ `ProductTemplate::testFormula()` —Å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º –ø–∞—Ä—Å–µ—Ä–æ–º.

### 2. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–ø—è—Ç—ã—Ö/—Ç–æ—á–µ–∫

–°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–∞–∫ `2.5`, —Ç–∞–∫ –∏ `2,5`, —á—Ç–æ —Ö–æ—Ä–æ—à–æ –¥–ª—è UX, –Ω–æ:
- –ü—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —á–∏—Å–ª–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–≤—ã—á–Ω—ã–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å

### 3. Debounce –≤ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏ vs onBlur –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- **–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ:** `live(debounce: 400)` - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å–ø—É—Å—Ç—è 400ms
  - ‚úÖ –ù–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏
  - ‚ùå –ï—Å—Ç—å –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ —Ä–∞—Å—á—ë—Ç–æ–º

- **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `live(onBlur: true)` - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Ñ–æ–∫—É—Å–∞
  - ‚úÖ –†–∞—Å—á—ë—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≥–æ—Ç–æ–≤
  - ‚ùå –ï—Å–ª–∏ –∑–∞–±—ã–ª –∫–ª–∏–∫–Ω—É—Ç—å - —Ä–∞—Å—á—ë—Ç –Ω–µ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç

### 4. –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤

```php
private static array $templateCache = [];  // –ö–µ—à –≤ –ø–∞–º—è—Ç–∏

public static function clearCache(): void {
    self::$templateCache = [];
}
```

- ‚úÖ –ò–∑–±–µ–≥–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î
- ‚ùå –ï—Å–ª–∏ —à–∞–±–ª–æ–Ω –æ–±–Ω–æ–≤–∏—Ç—Å—è –≤–æ –≤—Ä–µ–º—è —Å–µ—Å—Å–∏–∏ - –Ω–µ –æ–±–Ω–æ–≤–∏—Ç—Å—è –¥–æ –æ—á–∏—Å—Ç–∫–∏ –∫–µ—à–∞

---

## üìö –ò–°–ü–û–õ–¨–ó–£–ï–ú–´–ï –ö–õ–ê–°–°–´ –ò –§–ê–ô–õ–´

### Core Files
- `app/Support/ProductAttributeCalculator.php` - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è —Ä–∞—Å—á—ë—Ç–æ–≤
- `app/Models/ProductTemplate.php` - –º–æ–¥–µ–ª—å —à–∞–±–ª–æ–Ω–∞ —Å —Ñ–æ—Ä–º—É–ª–∞–º–∏
- `app/Models/Product.php` - –º–æ–¥–µ–ª—å —Ç–æ–≤–∞—Ä–∞
- `app/Models/Sale.php` - –º–æ–¥–µ–ª—å –ø—Ä–æ–¥–∞–∂–∏

### Filament Resources
- `app/Filament/Resources/ReceiptResource.php` - —Ñ–æ—Ä–º–∞ –ø—Ä–∏—ë–º–∫–∏
- `app/Filament/Resources/SaleResource.php` - —Ñ–æ—Ä–º–∞ –ø—Ä–æ–¥–∞–∂–∏
- `app/Filament/Resources/ProductInTransitResource.php` - —Ç–æ–≤–∞—Ä—ã –≤ –ø—É—Ç–∏

### Controllers
- `app/Http/Controllers/Api/ProductController.php` - API endpoints
- `app/Http/Controllers/ProductWebController.php` - –≤–µ–±-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä

---

## üîß –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –£–õ–£–ß–®–ï–ù–ò–Æ

1. **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å debounce/onBlur —Å—Ç—Ä–∞—Ç–µ–≥–∏—é** - –≤—ã–±—Ä–∞—Ç—å –æ–¥–Ω—É –ª–æ–≥–∏–∫—É –¥–ª—è –≤—Å–µ—Ö —Ñ–æ—Ä–º
2. **–î–æ–±–∞–≤–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ Redis** –≤–º–µ—Å—Ç–æ –ø–∞–º—è—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å JavaScript –≤–∞–ª–∏–¥–∞—Ü–∏—é** –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ª—É—á—à–µ–π UX
4. **–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º—É–ª** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
5. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã —á–∏—Å–µ–ª** –≤ UI (—Å–ø—Ä–∞–≤–∫–∞/tooltip)
6. **–ö–µ—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á—ë—Ç–æ–≤** –¥–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

## üìñ –°–°–´–õ–ö–ò –ù–ê –ö–û–î

- ProductAttributeCalculator: `app/Support/ProductAttributeCalculator.php` (188 —Å—Ç—Ä–æ–∫)
- ProductTemplate —Ñ–æ—Ä–º—É–ª—ã: `app/Models/ProductTemplate.php` (lines 68-311)
- ReceiptResource: `app/Filament/Resources/ReceiptResource.php` (lines 186-238)
- SaleResource: `app/Filament/Resources/SaleResource.php` (lines 61-78)

---

## üîÄ –î–ò–ê–ì–†–ê–ú–ú–´ –ü–û–¢–û–ö–û–í –î–ê–ù–ù–´–•

### –î–∏–∞–≥—Ä–∞–º–º–∞ 1: –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –≤–≤–æ–¥–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –≤ "–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞"

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ –í–í–û–î–ò–¢ –ó–ù–ê–ß–ï–ù–ò–ï –í –ü–û–õ–ï –•–ê–†–ê–ö–¢–ï–†–ò–°–¢–ò–ö–ò             ‚îÇ
‚îÇ  (–Ω–∞–ø—Ä–∏–º–µ—Ä: TextInput "–®–∏—Ä–∏–Ω–∞" = "50,5")                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  LIVEWIRE –û–ë–ù–ê–†–£–ñ–ò–í–ê–ï–¢ –ò–ó–ú–ï–ù–ï–ù–ò–ï (live: debounce: 400ms)       ‚îÇ
‚îÇ  ‚úì –û–∂–∏–¥–∞–µ—Ç 400ms –±–µ–∑ –Ω–æ–≤—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π                           ‚îÇ
‚îÇ  ‚úì –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç AJAX-–∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  FILAMENT –í–´–ó–´–í–ê–ï–¢ afterStateUpdated()                           ‚îÇ
‚îÇ  ‚îî‚îÄ> ReceiptResource::calculateVolumeForItem($set, $get)        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –ò–ó–í–õ–ï–ß–ï–ù–ò–ï –î–ê–ù–ù–´–• –ò–ó –§–û–†–ú–´ ($get())                           ‚îÇ
‚îÇ  {                                                               ‚îÇ
‚îÇ    'product_template_id' => 1,                                   ‚îÇ
‚îÇ    'quantity' => 10,                                             ‚îÇ
‚îÇ    'attribute_length' => '200',                                  ‚îÇ
‚îÇ    'attribute_width' => '50,5',        ‚Üê –í–í–û–î –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø      ‚îÇ
‚îÇ    'attribute_height' => '2,5',                                  ‚îÇ
‚îÇ    'attribute_wood_type' => '–°–æ—Å–Ω–∞'                             ‚îÇ
‚îÇ  }                                                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ProductAttributeCalculator::calculateAndUpdate()               ‚îÇ
‚îÇ  1. –í–∞–ª–∏–¥–∞—Ü–∏—è templateId                                        ‚îÇ
‚îÇ  2. –ó–∞–≥—Ä—É–∑–∫–∞ —à–∞–±–ª–æ–Ω–∞ –∏–∑ –∫–µ—à–∞                                    ‚îÇ
‚îÇ  3. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (extractAttributes)                    ‚îÇ
‚îÇ     ‚úì –ù–∞—Ö–æ–¥–∏—Ç –≤—Å–µ –∫–ª—é—á–∏ –≤–∏–¥–∞ "attribute_*"                     ‚îÇ
‚îÇ     ‚úì –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç: "50,5" ‚Üí 50.5                              ‚îÇ
‚îÇ  4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω–∏ (generateName)                              ‚îÇ
‚îÇ  5. –†–∞—Å—á—ë—Ç –æ–±—ä—ë–º–∞ (calculateVolume)                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  extractAttributes(): –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —á–∏—Å–µ–ª                        ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ INPUT: 'attribute_width' => '50,5'                       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ REGEX: str_replace(',', '.', '50,5')                    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ OUTPUT: 'width' => 50.5 (float)                         ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                                   ‚îÇ
‚îÇ  –†–µ–∑—É–ª—å—Ç–∞—Ç: $attributes = [                                    ‚îÇ
‚îÇ    'length' => 200,                                             ‚îÇ
‚îÇ    'width' => 50.5,      ‚Üê –ù–û–†–ú–ê–õ–ò–ó–û–í–ê–ù–û                       ‚îÇ
‚îÇ    'height' => 2.5,      ‚Üê –ù–û–†–ú–ê–õ–ò–ó–û–í–ê–ù–û                       ‚îÇ
‚îÇ    'wood_type' => '–°–æ—Å–Ω–∞'                                       ‚îÇ
‚îÇ  ]                                                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  generateName(): –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞                   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ –ë–µ—Ä—ë—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Å is_in_formula = true             ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ formulaParts = [200, 50.5, 2.5]                         ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                                                           ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ –ë–µ—Ä—ë—Ç –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏                          ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ regularParts = ['–°–æ—Å–Ω–∞']                                ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                                                           ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ –†–µ–∑—É–ª—å—Ç–∞—Ç: "–î–æ—Å–∫–∞: 200 x 50.5 x 2.5, –°–æ—Å–Ω–∞"           ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ  $set('name', '–î–æ—Å–∫–∞: 200 x 50.5 x 2.5, –°–æ—Å–Ω–∞')               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  calculateVolume(): –û—Å–Ω–æ–≤–Ω–æ–π —Ä–∞—Å—á—ë—Ç                             ‚îÇ
‚îÇ  1. –§–∏–ª—å—Ç—Ä —á–∏—Å–ª–æ–≤—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (> 0)                            ‚îÇ
‚îÇ     $numericAttributes = ['length' => 200, 'width' => 50.5,    ‚îÇ
‚îÇ                          'height' => 2.5]                      ‚îÇ
‚îÇ  2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ñ–æ—Ä–º—É–ª—ã                                   ‚îÇ
‚îÇ  3. –í—ã–∑–æ–≤ ProductTemplate::testFormula($numericAttributes)     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ProductTemplate::testFormula()                                 ‚îÇ
‚îÇ  1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑ —Ñ–æ—Ä–º—É–ª—ã                           ‚îÇ
‚îÇ     formula: "length * width * height / 1000"                  ‚îÇ
‚îÇ     variables: ['length', 'width', 'height']                   ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ  2. –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Ñ–æ—Ä–º—É–ª—É (regex —Å \b - –≥—Ä–∞–Ω–∏—Ü—ã —Å–ª–æ–≤) ‚îÇ
‚îÇ     expression = "200 * 50.5 * 2.5 / 1000"                    ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ  3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ (evaluateExpression)                 ‚îÇ
‚îÇ     ‚úì –í–∞–ª–∏–¥–∞—Ü–∏—è regex: —Ç–æ–ª—å–∫–æ [0-9+\-*\/\(\)\.]              ‚îÇ
‚îÇ     ‚úì –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–∞—Ä—Å–µ—Ä —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –æ–ø–µ—Ä–∞—Ü–∏–π              ‚îÇ
‚îÇ     ‚úì –í—ã—á–∏—Å–ª–µ–Ω–∏–µ: (200 * 50.5 * 2.5) / 1000 = 25.25          ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ  4. –í–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞                                         ‚îÇ
‚îÇ     return [                                                    ‚îÇ
‚îÇ       'success' => true,                                        ‚îÇ
‚îÇ       'error' => null,                                          ‚îÇ
‚îÇ       'result' => 25.250  ‚Üê –û–ö–†–£–ì–õ–ï–ù–û –î–û 3 –ó–ù–ê–ö–û–í             ‚îÇ
‚îÇ     ]                                                           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –£–°–¢–ê–ù–û–í–ö–ê –†–ï–ó–£–õ–¨–¢–ê–¢–ê –í –§–û–†–ú–£                                   ‚îÇ
‚îÇ  $set('calculated_volume', 25.250)                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  LIVEWIRE –û–ë–ù–û–í–õ–Ø–ï–¢ UI (—Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)                  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ –ü–æ–ª–µ "–û–±—ä–µ–º" –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è:                               ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ –ë—ã–ª–æ: [–ø—É—Å—Ç–æ]                                           ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ –°—Ç–∞–ª–æ: 25.250 –º¬≥                                        ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îÇ  ‚úì –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ (number_format)             ‚îÇ
‚îÇ  ‚úì –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –î–∏–∞–≥—Ä–∞–º–º–∞ 2: –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –≤–≤–æ–¥–µ —Å—É–º–º—ã –≤ "–†–µ–∞–ª–∏–∑–∞—Ü–∏—è"

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ –í–í–û–î–ò–¢ –°–£–ú–ú–£ –í –ü–û–õ–ï                                ‚îÇ
‚îÇ  –ù–∞–ª–∏—á–Ω—ã–µ: [____]  ‚Üí  –í–≤–æ–¥: "1000"                              ‚îÇ
‚îÇ  –ë–µ–∑–Ω–∞–ª–∏—á–Ω—ã–µ: [____]  ‚Üí  –í–≤–æ–¥: "500,50"                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  LIVEWIRE –û–ë–ù–ê–†–£–ñ–ò–í–ê–ï–¢ –ü–û–¢–ï–†–Æ –§–û–ö–£–°–ê (live: onBlur: true)       ‚îÇ
‚îÇ  ‚úì –ú–∞—Å–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è                  ‚îÇ
‚îÇ    "1000" ‚Üí "1 000,00" (—Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º —Ç—ã—Å—è—á –∏ 2 –∑–Ω–∞–∫–∞)       ‚îÇ
‚îÇ  ‚úì –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç AJAX-–∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Ñ–æ–∫—É—Å–∞         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  FILAMENT –í–´–ó–´–í–ê–ï–¢ afterStateUpdated()                            ‚îÇ
‚îÇ  ‚îî‚îÄ> SaleResource::calculateTotalPrice($set, $get)              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –ü–û–õ–£–ß–ï–ù–ò–ï –ó–ù–ê–ß–ï–ù–ò–ô –ò–ó –§–û–†–ú–´ ($get())                            ‚îÇ
‚îÇ  {                                                                ‚îÇ
‚îÇ    'cash_amount' => '1 000,00',      ‚Üê –û–¢–§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–û         ‚îÇ
‚îÇ    'nocash_amount' => '500,50'        ‚Üê –û–¢–§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–û         ‚îÇ
‚îÇ  }                                                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  calculateTotalPrice() - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ —Ä–∞—Å—á—ë—Ç                   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ 1. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫ –≤ float                            ‚îÇ ‚îÇ
‚îÇ  ‚îÇ    $cashRaw = (string) '1 000,00'                          ‚îÇ ‚îÇ
‚îÇ  ‚îÇ    str_replace(',', '.', '1 000,00')  ‚Üê –û–®–ò–ë–ö–ê!           ‚îÇ ‚îÇ
‚îÇ  ‚îÇ    –†–µ–∑—É–ª—å—Ç–∞—Ç: '1 000.00' ‚Üê –ø—Ä–æ–±–µ–ª—ã –Ω–µ —É–¥–∞–ª–µ–Ω—ã!            ‚îÇ ‚îÇ
‚îÇ  ‚îÇ                                                             ‚îÇ ‚îÇ
‚îÇ  ‚îÇ    PHP –ü–†–ï–û–ë–†–ê–ó–£–ï–¢ –ö FLOAT (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ–±–µ–ª):           ‚îÇ ‚îÇ
‚îÇ  ‚îÇ    (float) '1 000.00' = 1.0 ‚Üê –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û!                ‚îÇ ‚îÇ
‚îÇ  ‚îÇ                                                             ‚îÇ ‚îÇ
‚îÇ  ‚îÇ –í–ê–ñ–ù–û: –≠—Ç–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞!                          ‚îÇ ‚îÇ
‚îÇ  ‚îÇ –ù—É–∂–Ω–æ —É–¥–∞–ª—è—Ç—å –ø—Ä–æ–±–µ–ª—ã –ø–µ—Ä–µ–¥ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º                ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                                    ‚îÇ
‚îÇ  2. –†–∞—Å—á—ë—Ç —Å—É–º–º—ã (–ø—Ä–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏)                  ‚îÇ
‚îÇ    $cashAmount = 1000.00                                          ‚îÇ
‚îÇ    $nocashAmount = 500.50                                         ‚îÇ
‚îÇ    $totalPrice = 1000.00 + 500.50 = 1500.50                     ‚îÇ
‚îÇ                                                                    ‚îÇ
‚îÇ  3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞                                         ‚îÇ
‚îÇ    $set('total_price', 1500.50)                                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –õ–û–ì–ò–†–û–í–ê–ù–ò–ï                                                      ‚îÇ
‚îÇ  Log::info('Sale form: calculateTotalPrice', [                   ‚îÇ
‚îÇ    'cash_amount' => 1000.00,                                     ‚îÇ
‚îÇ    'nocash_amount' => 500.50,                                    ‚îÇ
‚îÇ    'total_price' => 1500.50,                                     ‚îÇ
‚îÇ  ])                                                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  LIVEWIRE –û–ë–ù–û–í–õ–Ø–ï–¢ UI                                            ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ –ü–æ–ª–µ "–û–±—â–∞—è —Å—É–º–º–∞" –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è:                            ‚îÇ ‚îÇ
‚îÇ  ‚îÇ –ë—ã–ª–æ: [–ø—É—Å—Ç–æ]                                              ‚îÇ ‚îÇ
‚îÇ  ‚îÇ –°—Ç–∞–ª–æ: 1500.50                                             ‚îÇ ‚îÇ
‚îÇ  ‚îÇ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ: 1 500,50 (—Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º)                 ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –î–∏–∞–≥—Ä–∞–º–º–∞ 3: –ò–µ—Ä–∞—Ä—Ö–∏—è –∫–ª–∞—Å—Å–æ–≤ –∏ –º–µ—Ç–æ–¥–æ–≤

```
                    FILAMENT RESOURCE
                          ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ                 ‚îÇ                 ‚îÇ
   ReceiptResource   SaleResource   ProductInTransitResource
        ‚îÇ                 ‚îÇ                 ‚îÇ
        ‚îú‚îÄ Form()         ‚îú‚îÄ Form()        ‚îî‚îÄ Form()
        ‚îÇ  ‚îÇ              ‚îÇ  ‚îÇ
        ‚îÇ  ‚îú‚îÄ Repeater    ‚îÇ  ‚îî‚îÄ Grid (cash_amount, nocash_amount, total_price)
        ‚îÇ  ‚îÇ  ‚îÇ           ‚îÇ     ‚îÇ
        ‚îÇ  ‚îÇ  ‚îú‚îÄ Select    ‚îÇ     ‚îî‚îÄ afterStateUpdated ‚Üí calculateTotalPrice()
        ‚îÇ  ‚îÇ  ‚îÇ  (template_id)    ‚îÇ
        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ                ‚îî‚îÄ norms: ',.' ‚Üí '.', adds numbers
        ‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ afterStateUpdated
        ‚îÇ  ‚îÇ  ‚îÇ
        ‚îÇ  ‚îÇ  ‚îú‚îÄ TextInput (quantity, attributes)
        ‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ
        ‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ live(debounce: 400)
        ‚îÇ  ‚îÇ  ‚îÇ     ‚îî‚îÄ afterStateUpdated ‚Üí calculateVolumeForItem()
        ‚îÇ  ‚îÇ  ‚îÇ        ‚îÇ
        ‚îÇ  ‚îÇ  ‚îÇ        ‚îî‚îÄ CALLS
        ‚îÇ  ‚îÇ  ‚îÇ           ‚îÇ
        ‚îÇ  ‚îÇ  ‚îî‚îÄ TextInput (calculated_volume, readonly)
        ‚îÇ  ‚îÇ
        ‚îÇ  ‚îî‚îÄ ProductAttributeCalculator
        ‚îÇ     ‚îÇ
        ‚îÇ     ‚îú‚îÄ calculateAndUpdate()
        ‚îÇ     ‚îÇ  ‚îú‚îÄ 1Ô∏è‚É£  extractAttributes()     ‚Üê Extract attribute_* keys
        ‚îÇ     ‚îÇ  ‚îÇ       ‚îú‚îÄ Normalize: ',' ‚Üí '.'
        ‚îÇ     ‚îÇ  ‚îÇ       ‚îî‚îÄ Return: $attributes
        ‚îÇ     ‚îÇ  ‚îÇ
        ‚îÇ     ‚îÇ  ‚îú‚îÄ 2Ô∏è‚É£  generateName()          ‚Üê Build product name
        ‚îÇ     ‚îÇ  ‚îÇ       ‚îú‚îÄ Separate formula vs regular parts
        ‚îÇ     ‚îÇ  ‚îÇ       ‚îî‚îÄ Return: "Product: 200 x 50.5, S–æ—Å–Ω–∞"
        ‚îÇ     ‚îÇ  ‚îÇ
        ‚îÇ     ‚îÇ  ‚îî‚îÄ 3Ô∏è‚É£  calculateVolume()        ‚Üê Compute volume
        ‚îÇ     ‚îÇ         ‚îÇ
        ‚îÇ     ‚îÇ         ‚îî‚îÄ CALLS
        ‚îÇ     ‚îÇ
        ‚îÇ     ‚îî‚îÄ ProductTemplate::testFormula()
        ‚îÇ        ‚îÇ
        ‚îÇ        ‚îú‚îÄ 1Ô∏è‚É£  extractVariablesFromFormula()
        ‚îÇ        ‚îÇ       ‚îú‚îÄ Regex: /[a-zA-Z_][a-zA-Z0-9_]*/
        ‚îÇ        ‚îÇ       ‚îî‚îÄ Filter out: sin, cos, sqrt, etc.
        ‚îÇ        ‚îÇ
        ‚îÇ        ‚îú‚îÄ 2Ô∏è‚É£  Substitute variables in formula
        ‚îÇ        ‚îÇ       ‚îú‚îÄ Regex: /\b{variable}\b/
        ‚îÇ        ‚îÇ       ‚îî‚îÄ Result: "200 * 50.5 * 2.5 / 1000"
        ‚îÇ        ‚îÇ
        ‚îÇ        ‚îî‚îÄ 3Ô∏è‚É£  evaluateExpression()
        ‚îÇ                ‚îú‚îÄ Validate: /^[0-9+\-*\/\(\)\.]+$/
        ‚îÇ                ‚îú‚îÄ parseExpression()
        ‚îÇ                ‚îÇ   ‚îú‚îÄ validateParentheses()
        ‚îÇ                ‚îÇ   ‚îî‚îÄ evaluateExpressionRecursive()
        ‚îÇ                ‚îÇ       ‚îú‚îÄ Handle operator precedence
        ‚îÇ                ‚îÇ       ‚îî‚îÄ Calculate recursively
        ‚îÇ                ‚îî‚îÄ Return: 25.25
```

### –î–∏–∞–≥—Ä–∞–º–º–∞ 4: –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª Livewire –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –ø—Ä–∏ –≤–≤–æ–¥–µ –¥–∞–Ω–Ω—ã—Ö

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  1Ô∏è‚É£  –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ö–û–ú–ü–û–ù–ï–ù–¢–ê                                 ‚îÇ
‚îÇ     ‚îú‚îÄ mount() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è                                      ‚îÇ
‚îÇ     ‚îú‚îÄ $template = ProductTemplate::find(1)                    ‚îÇ
‚îÇ     ‚îî‚îÄ schema() –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–æ–ª—è –Ω–∞ –æ—Å–Ω–æ–≤–µ $template            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  2Ô∏è‚É£  –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ –í–´–ë–ò–†–ê–ï–¢ –®–ê–ë–õ–û–ù (live)                      ‚îÇ
‚îÇ     ‚îú‚îÄ AJAX: product_template_id = 1                           ‚îÇ
‚îÇ     ‚îú‚îÄ Livewire –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ                            ‚îÇ
‚îÇ     ‚îú‚îÄ afterStateUpdated –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è                            ‚îÇ
‚îÇ     ‚îÇ  ‚îú‚îÄ $set('name', '')                                     ‚îÇ
‚îÇ     ‚îÇ  ‚îú‚îÄ $set('calculated_volume', null)                      ‚îÇ
‚îÇ     ‚îÇ  ‚îî‚îÄ schema() –ü–ï–†–ï–ì–ï–ù–ï–†–ò–†–£–ï–¢–°–Ø —Å –Ω–æ–≤—ã–º–∏ –ø–æ–ª—è–º–∏!           ‚îÇ
‚îÇ     ‚îî‚îÄ HTML –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è (–Ω–æ–≤—ã–µ –ø–æ–ª—è –¥–ª—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫)        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  3Ô∏è‚É£  –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ –í–í–û–î–ò–¢ –•–ê–†–ê–ö–¢–ï–†–ò–°–¢–ò–ö–£ (live debounce: 400)  ‚îÇ
‚îÇ     ‚îú‚îÄ –í–≤–æ–¥: TextInput "width" = "50,5"                        ‚îÇ
‚îÇ     ‚îú‚îÄ –ñ–î–Å–ú 400ms –ë–ï–ó –ù–û–í–´–• –ò–ó–ú–ï–ù–ï–ù–ò–ô                         ‚îÇ
‚îÇ     ‚îú‚îÄ AJAX –∑–∞–ø—Ä–æ—Å: attribute_width = "50,5"                   ‚îÇ
‚îÇ     ‚îú‚îÄ Livewire –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ                            ‚îÇ
‚îÇ     ‚îú‚îÄ afterStateUpdated –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è                            ‚îÇ
‚îÇ     ‚îÇ  ‚îî‚îÄ calculateVolumeForItem($set, $get)                   ‚îÇ
‚îÇ     ‚îÇ     ‚îî‚îÄ ProductAttributeCalculator::calculateAndUpdate()  ‚îÇ
‚îÇ     ‚îî‚îÄ $set('calculated_volume', 25.25) –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  4Ô∏è‚É£  LIVEWIRE RE-RENDERS –ö–û–ú–ü–û–ù–ï–ù–¢                             ‚îÇ
‚îÇ     ‚îú‚îÄ –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–æ–≤—ã–π HTML                                 ‚îÇ
‚îÇ     ‚îú‚îÄ –¢–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —á–∞—Å—Ç–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É            ‚îÇ
‚îÇ     ‚îú‚îÄ JavaScript –æ–±–Ω–æ–≤–ª—è–µ—Ç DOM                                ‚îÇ
‚îÇ     ‚îî‚îÄ –ü–æ–ª–µ "–û–±—ä–µ–º" —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: 25.250 –º¬≥             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  5Ô∏è‚É£  –°–û–•–†–ê–ù–ï–ù–ò–ï –î–ê–ù–ù–´–• (Save)                                  ‚îÇ
‚îÇ     ‚îú‚îÄ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–µ—Ç "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"                        ‚îÇ
‚îÇ     ‚îú‚îÄ –§–æ—Ä–º–∞ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è                                      ‚îÇ
‚îÇ     ‚îú‚îÄ mutateFormDataBeforeSave() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è                   ‚îÇ
‚îÇ     ‚îÇ  ‚îî‚îÄ –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º                  ‚îÇ
‚îÇ     ‚îú‚îÄ Product::create($data) —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ë–î                  ‚îÇ
‚îÇ     ‚îî‚îÄ –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üìù –û–ë–ù–û–í–õ–ï–ù–ò–ï (19.10.2025)

### –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** –†–∞–∑–¥–µ–ª "–†–µ–∞–ª–∏–∑–∞—Ü–∏—è" –±—ã–ª –æ–±–Ω–æ–≤–ª—ë–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –µ–¥–∏–Ω–æ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º–∞ —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å–æ –≤—Å–µ–º–∏ –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞–º–∏.

**–î–æ:**
```php
// SaleResource - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
TextInput::make('cash_amount')
    ->live(onBlur: true)  // –†–∞—Å—á—ë—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Ñ–æ–∫—É—Å–∞
```

**–ü–æ—Å–ª–µ:**
```php
// SaleResource - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
TextInput::make('cash_amount')
    ->live(debounce: 400)  // –†–∞—Å—á—ë—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ 400ms
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–π UX - –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –º–µ—Ö–∞–Ω–∏–∑–º –≤–µ–∑–¥–µ
- ‚úÖ –õ—É—á—à–∞—è –æ—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç—å - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∏–¥–Ω–æ —Å—Ä–∞–∑—É –±–µ–∑ –∫–ª–∏–∫–æ–≤
- ‚úÖ –ú–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - –∑–∞–±—ã–ª–∏ –∫–ª–∏–∫–Ω—É—Ç—å = —Ä–∞—Å—á—ë—Ç –Ω–µ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä - 400ms debounce —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω

**–§–∞–π–ª—ã, –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ:**
- `app/Filament/Resources/SaleResource.php` (—Å—Ç—Ä–æ–∫–∏ 359, 369)
